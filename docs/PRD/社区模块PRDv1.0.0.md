## 社区模块V1.0.0-PRD（优化版）

## 一、背景与目标

Code-Nest项目社区模块旨在构建一个完整的技术交流社区平台，支持用户发帖讨论、互动交流，并提供完善的后台管理功能。参考CSDN等技术社区的交互模式，打造适合开发者的交流环境。

------

## 二、用户角色

### 1. 普通用户（前台）
- 注册/登录后可发帖、评论
- 浏览帖子，支持按分类筛选
- 点赞、收藏帖子和评论
- 查看个人发帖、收藏记录
- 受封禁机制约束

### 2. 管理员（后台）
- 全面的帖子管理（置顶、下架、删除）
- 分类体系管理（增删改查）
- 评论内容管理
- 用户封禁管理（支持时长设置）
- 数据统计和监控

------

## 三、功能需求

### 1. 前台（用户端）功能

#### 1.1 帖子功能
- **创建帖子**
  - 标题、内容（支持Markdown）
  - 分类选择（必填）
  - 发布前封禁状态检查
  
- **帖子浏览**
  - 帖子列表（置顶优先 + 时间倒序）
  - 分类筛选、关键词搜索
  - 分页加载
  
- **帖子详情**
  - 完整内容展示
  - 浏览次数自动计数
  - 点赞、收藏状态显示
  - 统计数据展示（点赞数、评论数、收藏数）
  
- **互动功能**
  - 点赞帖子（支持取消，实时更新计数）
  - 收藏帖子（支持取消收藏）
  - 分享功能

#### 1.2 评论功能
- **发布评论**
  - 纯文本评论
  - 发布前封禁状态检查
  
- **评论交互**
  - 评论列表分页展示
  - 点赞评论（支持取消）
  - 评论时间排序

#### 1.3 分类系统
- **分类浏览**
  - 分类列表展示
  - 按分类筛选帖子
  - 分类统计信息

#### 1.4 个人中心
- **我的收藏**：收藏的帖子列表
- **我的发帖**：个人发帖历史
- **我的评论**：个人评论记录
- **活动统计**：发帖数、评论数、获赞数等

------

### 2. 后台（管理端）功能

#### 2.1 帖子管理
- **帖子列表**
  - 全量帖子查看
  - 多维度筛选（时间、用户、状态、分类）
  - 批量操作支持
  
- **帖子操作**
  - 置顶设置（支持时长配置，小时级）
  - 状态管理（正常/下架/删除）
  - 帖子详情查看
  
- **置顶管理**
  - 置顶时长设置
  - 自动到期取消置顶
  - 置顶帖子优先展示

#### 2.2 分类管理
- **分类CRUD**
  - 创建、编辑、删除分类
  - 分类排序设置
  - 分类状态管理
  
- **分类统计**
  - 各分类帖子数量统计
  - 分类活跃度分析

#### 2.3 评论管理
- **评论列表**
  - 全量评论查看
  - 按帖子、用户筛选
  - 评论内容审核
  
- **评论操作**
  - 删除违规评论
  - 评论状态管理

#### 2.4 用户管理
- **用户状态管理**
  - 用户社区行为统计
  - 发帖数、评论数、点赞数、收藏数统计
  
- **封禁功能**
  - 用户封禁（支持时长设置）
  - 封禁原因记录
  - 自动到期解封
  - 手动解封操作
  
- **用户记录查看**
  - 用户发帖历史
  - 用户评论记录
  - 用户行为轨迹

------

## 四、核心流程

### 1. 用户交互流程
1. **发帖流程**：登录 → 封禁检查 → 选择分类 → 编写内容 → 发布 → 统计更新
2. **互动流程**：浏览帖子 → 点赞/收藏 → 发表评论 → 评论互动
3. **个人管理**：查看个人中心 → 管理收藏/发帖记录

### 2. 管理员操作流程
1. **内容管理**：登录后台 → 查看帖子/评论 → 执行管理操作（置顶/删除等）
2. **用户管理**：查看用户列表 → 分析用户行为 → 执行封禁/解封操作
3. **分类管理**：管理分类体系 → 优化分类结构

### 3. 系统自动化流程
1. **置顶到期**：定时检查置顶过期 → 自动取消置顶
2. **封禁到期**：定时检查封禁过期 → 自动解封
3. **统计更新**：实时更新各类计数统计

------

## 五、技术特性

### 1. 数据统计
- **帖子统计**：浏览量、点赞数、评论数、收藏数
- **用户统计**：发帖数、评论数、获赞数、收藏数
- **实时计数**：所有交互行为实时更新统计

### 2. 状态管理
- **帖子状态**：正常(1)、下架(2)、删除(3)
- **用户状态**：正常、封禁（支持时长）
- **置顶状态**：支持时长设置，自动过期

### 3. 权限控制
- **封禁机制**：封禁用户无法发帖、评论、点赞、收藏
- **管理权限**：后台功能需要管理员权限
- **自动检查**：操作前自动检查用户封禁状态

### 4. 用户体验优化
- **分页加载**：列表数据分页展示，提升性能
- **实时反馈**：点赞、收藏等操作实时更新UI
- **状态记忆**：记住用户的点赞、收藏状态

------

## 六、数据结构设计

### 1. 核心实体
- **CommunityPost**：帖子（含置顶、统计字段）
- **CommunityCategory**：分类
- **CommunityComment**：评论
- **CommunityUserStatus**：用户社区状态（封禁、统计）

### 2. 关联实体
- **CommunityPostLike**：帖子点赞记录
- **CommunityPostCollect**：帖子收藏记录
- **CommunityCommentLike**：评论点赞记录

------

## 七、功能特色

1. **完善的分类体系**：支持分类管理和筛选
2. **智能置顶机制**：支持时长设置，自动过期管理
3. **精细化封禁控制**：支持时长设置，自动解封
4. **全面的数据统计**：用户行为和内容互动全量统计
5. **实时交互体验**：点赞、收藏等操作实时生效
6. **双端分离设计**：前台用户端和后台管理端分离